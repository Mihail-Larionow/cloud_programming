## –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ3 "–†–∞–±–æ—Ç–∞ —Å CI/CD"

### –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Github Actions –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–±–æ—Ä–∫—É –¥–æ–∫–µ—Ä –æ–±—Ä–∞–∑–∞ –Ω–∞ –∫–∞–∂–¥—ã–π 
push –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, –∞ —Ç–∞–∫–∂–µ –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –µ–≥–æ —Å–±–æ—Ä–∫–∏ –≤ 
–æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –æ–±—Ä–∞–∑–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ <font color="aqua">Dockerhub</font>.

### –ó–∞–¥–∞—á–∏
1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª .yaml —Å –±—É–¥—É—â–∏–º Github Action –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ .github –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è, 
–æ–±–æ–∑–Ω–∞—á–∏—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–Ω–∞ –∫–∞–∂–¥—ã–π push);
2. –°–æ–∑–¥–∞—Ç—å Job "build_and_run" –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏ <font color="aqua">Docker</font> –æ–±—Ä–∞–∑–∞;
3. –°–æ–∑–¥–∞—Ç—å Job "build_and_push_to_dockerhub" –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏ <font color="aqua">Docker</font> –æ–±—Ä–∞–∑–∞ –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è 
—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ <font color="aqua">Dockerhub</font>;


### –•–æ–¥ —Ä–∞–±–æ—Ç—ã

#### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Github Action
–í –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `.github`, –≤ –Ω–µ–π –±—ã–ª —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `ci.yaml`.
–ë—ã–ª–æ –∑–∞–¥–∞–Ω–æ –∏–º—è –¥–ª—è Github Action, –∞ —Ç–∞–∫–∂–µ –±–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
```yaml
name: CI Pipeline ‚Äì lab3
on:
  push:
    branches:
      - main
```
–¢–∞–∫–∞—è –∑–∞–ø–∏—Å—å –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ action –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –Ω–∞ –∫–∞–∂–¥—ã–π push –≤ –≤–µ—Ç–∫—É main.

#### 2. –°–æ–∑–¥–∞–Ω–∏–µ Job "build_and_run"

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–±–æ—Ä–∫—É <font color="aqua">Docker</font> –æ–±—Ä–∞–∑–∞ –Ω–∞ –∫–∞–∂–¥—ã–π push –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π,
–±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ **–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞**. –ü–æ –ø—É—Ç–∏ `lab3/task_simple` –±—ã–ª 
—Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª **Dockerfile**:

```dockerfile
FROM ubuntu:20.04

RUN echo "Built successfully üíã" > build.txt

CMD ["cat", "build.txt"]

```
>Note: –¢–∞–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è <font color="aqua">Dockerfile</font> —Å–æ–∑–¥–∞—ë—Ç –æ–±—Ä–∞–∑ <font color="aqua">Docker</font> –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±—Ä–∞–∑–∞ Ubuntu 
–≤–µ—Ä—Å–∏–∏ 20.04. –¢–µ–∫—Å—Ç _Built successfully üíã_ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Ñ–∞–π–ª `build.txt`. –î–∞–ª–µ–µ
–≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `build.txt`.

 
–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–±–æ—Ä–∫—É —Ñ–∞–π–ª–∞ –Ω–∞ –∫–∞–∂–¥—ã–π push, –≤ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Github Action –±—ã–ª–æ
–¥–æ–±–∞–≤–ª–µ–Ω–æ —Å–ª–µ–¥—É—é—â–µ–µ:
```yaml
name: CI Pipeline ‚Äì lab3
on:
  push:
    branches:
      - main
    paths:
      - "lab3/**"

jobs:
  build_and_run:
    runs-on: ubuntu-20.04
    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Build Docker image
        run: docker build -t lab3-app lab3/task_simple

      - name: Run lab3 docker image
        run: docker run lab3-app
```
–ë—ã–ª–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ Job –¥–ª—è —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞, –¥–ª—è –µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è:

 - `paths: - "lab3/**"` ‚Äì workflow –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–∞–ø–∫–µ lab3/**;

 - `steps:` ‚Äì –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —à–∞–≥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –≤ —Ä–∞–º–∫–∞—Ö job:

   - **Checkout** ‚Äì –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ `actions/checkout@v2`–¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–¥–∞ –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è;

   - **Build Docker image** ‚Äì —Å—Ç—Ä–æ–∏—Ç –æ–±—Ä–∞–∑ –∏–∑ <font color="aqua">Dockerfile</font> –∏ –ø–æ–º–µ—á–∞–µ—Ç –µ–≥–æ —Ç–µ–≥–æ–º **lab3-app**;

   - **Run lab3 docker image** ‚Äì –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—É—Å–∫ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ Docker –æ–±—Ä–∞–∑–∞. –ü–æ—Å–∫–æ–ª—å–∫—É –≤ <font color="aqua">Dockerfile</font> —É–∫–∞–∑–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `CMD`, 
   –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–≤–µ–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `build.txt`.

#### 3. –°–æ–∑–¥–∞–Ω–∏–µ Job "build_and_push_to_dockerhub"

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—Ä–∞–∑–∞ –≤ –æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –æ–±—Ä–∞–∑–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ <font color="aqua">Dockerhub</font>,
–±—ã–ª —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π Job:

```yaml
  build_and_push_to_dockerhub:
    runs-on: ubuntu-20.04
    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Login to DockerHub
        uses: docker/login-action@v3
        with:
            username: ${{ secrets.DOCKERHUB_USERNAME }}
            password: ${{ secrets.DOCKERHUB_ACCESS_TOKEN }}

      - name: Build and push Docker image
        uses: docker/build-push-action@v2
        with:
            context: lab3/task_simple
            push: true
            tags: lnikm/cloud_programming:latest
```
 - **Login to DockerHub** ‚Äì –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ <font color="aqua">Dockerhub</font> —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Ö—Ä–∞–Ω—è—â–∏—Ö—Å—è –≤ —Å–µ–∫—Ä–µ—Ç–∞—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (`DOCKERHUB_USERNAME` –∏ `DOCKERHUB_ACCESS_TOKEN`);

 - **Build and push Docker image** ‚Äì –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ docker/build-push-action@v2
–¥–ª—è —Å–±–æ—Ä–∫–∏ Docker –æ–±—Ä–∞–∑–∞ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ `lab3/task_simple`. –≠—Ç–æ—Ç —à–∞–≥ –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—Ä–∞–Ω–Ω—ã–π –æ–±—Ä–∞–∑ 
–Ω–∞ <font color="aqua">Dockerhub</font>. –ü–∞—Ä–∞–º–µ—Ç—Ä `push: true` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏, –∞ `tags: lnikm/cloud_programming:latest` 
–∑–∞–¥–∞—ë—Ç —Ç–µ–≥, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –æ–±—Ä–∞–∑–∞.

## –í—ã–≤–æ–¥
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, Github Actions –±—ã–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–±–æ—Ä–∫—É 
–¥–æ–∫–µ—Ä –æ–±—Ä–∞–∑–∞ –Ω–∞ –∫–∞–∂–¥—ã–π push –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, –∞ —Ç–∞–∫–∂–µ –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –µ–≥–æ —Å–±–æ—Ä–∫–∏ –≤ 
–æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –æ–±—Ä–∞–∑–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ <font color="aqua">Dockerhub</font>.

---
## ‚≠ê 
### –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã
—Ü–µ–ª–∏ –ø–æ–∫–∞ –Ω–µ—Ç
